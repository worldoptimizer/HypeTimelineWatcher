/*
 Hype Timeline Watcher Extension
 Copyright (2024) Max Ziebell, (https://maxziebell.de). MIT-license
*/
'use strict';!1==="HypeTimelineWatcher"in window&&(window.HypeTimelineWatcher=function(){function g(b){return Math.round(1E3*b)/1E3}function m(b,a,c){b=b.documentId();return c?b+":"+c.element().id+":"+a:b+":"+a}function n(b,a,c=null){b=m(b,a,c);delete h[b];0===Object.keys(h).length&&f&&(cancelAnimationFrame(f),f=null)}function p(b,a,c,d){var e=m(b,c,a);h[e]={onTimelineProgress:d.onTimelineProgress,onTimelineComplete:d.onTimelineComplete,onTimelineStart:d.onTimelineStart,onTimelinePause:d.onTimelinePause,
onTimelineResume:d.onTimelineResume,lastTime:-1,lastState:"stopped",hypeDocument:b,symbolInstance:a,timelineName:c};f||=requestAnimationFrame(q)}function q(){for(var b in h)if(h.hasOwnProperty(b)){var a=h[b];if(a.symbolInstance){var c=g(a.symbolInstance.currentTimeInTimelineNamed(a.timelineName));var d=a.symbolInstance.isPlayingTimelineNamed(a.timelineName)}else c=g(a.hypeDocument.currentTimeInTimelineNamed(a.timelineName)),d=a.hypeDocument.isPlayingTimelineNamed(a.timelineName);var e=c!==a.lastTime;
e&&(a.lastTime=c,"playing"==a.lastState&&k(a.hypeDocument,a.symbolInstance,a.timelineName,a.onTimelineProgress,"onTimelineProgress",c));e?("stopped"===a.lastState&&(k(a.hypeDocument,a.symbolInstance,a.timelineName,a.onTimelineStart,"onTimelineStart"),a.lastState="playing"),c=a,e=a.timelineName,c=c.symbolInstance?g(c.symbolInstance.currentTimeInTimelineNamed(e))===g(c.symbolInstance.durationForTimelineNamed(e)):g(c.hypeDocument.currentTimeInTimelineNamed(e))===g(c.hypeDocument.durationForTimelineNamed(e)),
c&&(k(a.hypeDocument,a.symbolInstance,a.timelineName,a.onTimelineComplete,"onTimelineComplete"),a.lastState="stopped"),d&&"paused"===a.lastState&&(k(a.hypeDocument,a.symbolInstance,a.timelineName,a.onTimelineResume,"onTimelineResume"),a.lastState="playing")):d||"playing"!==a.lastState||(k(a.hypeDocument,a.symbolInstance,a.timelineName,a.onTimelinePause,"onTimelinePause"),a.lastState="paused")}f=requestAnimationFrame(q)}function k(b,a,c,d,e,l=null){c={timelineName:c,symbolInstance:a,currentTime:l};
a=a?a.element():document.getElementById(b.currentSceneId());d&&"function"===typeof d&&d(b,a,c);if("function"===typeof b.functions()[e])b.functions()[e](b,a,c);if("function"===typeof b[e])b[e](b,a,c)}!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);var h={},f=null;window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(b,a,c){b.isTimelineComplete=function(d){return g(b.currentTimeInTimelineNamed(d))===g(b.durationForTimelineNamed(d))};b.watchTimelineByName=function(d,
e={}){p(b,null,d,e)};b.unwatchTimelineByName=function(d){n(b,d)}}});window.HYPE_eventListeners.push({type:"HypeSymbolLoad",callback:function(b,a,c){var d=b.getSymbolInstanceById(a.id);d.isTimelineComplete=function(e){return g(d.currentTimeInTimelineNamed(e))===g(d.durationForTimelineNamed(e))};d.watchTimelineByName=function(e,l={}){p(b,d,e,l)};d.unwatchTimelineByName=function(e){n(b,e,d)}}});window.HYPE_eventListeners.push({type:"HypeTimelineComplete",callback:function(b,a,c){a=a?b.getSymbolInstanceById(a.id):
null;k(b,a,c.timelineName,null,"HypeTimelineComplete")}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(b,a,c){h={};f&&(cancelAnimationFrame(f),f=null)}});window.HYPE_eventListeners.push({type:"HypeSceneUnload",callback:function(b,a,c){h={};f&&(cancelAnimationFrame(f),f=null)}});return{version:"1.1.2"}}());
